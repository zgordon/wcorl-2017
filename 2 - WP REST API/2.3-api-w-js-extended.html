<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <title>JavaScript for WordPress</title>
    <link rel="stylesheet" href="../shared/style.css">
</head>
<body>

<div id="page">

    <header id="masthead" class="site-header" role="banner">

        <div class="site-branding">
            <p class="site-title">JavaScript for WordPress</a></p>
            <p class="site-description">Just another JS and WP Site</p>
        </div>

    </header>

    <div id="content" class="site-content">

        <div id="primary" class="content-area">
            <main id="main" class="site-main" role="main"></main>
        </div>


        <aside id="secondary" class="widget-area" role="complementary">
            <div class="widget">
                <h3>Welcome!</h3>
                <p>This site is JavaScript powered.</p>
            </div>

        </aside>

    </div><!-- #content -->

    <footer id="colophon" class="site-footer" role="contentinfo">

        <p>Proudly powered with JavaScript and WordPress.</p>

    </footer>

</div><!-- #page -->

<!--  Include the Axios AJAX Library  -->
<script src="../shared/axios.js" type="text/javascript"></script>
<script type="text/javascript">

    // Get the ul for the posts to display
    // Set the URL for your WP API Root (ie https://www.example.dev/wp-json/)
    const   container = document.getElementById( '__CHANGE__' ),
            wpRestUrl = '__CHANGE__';

    (function init(){

        // Call getPosts();
        __CHANGE__;

    })();

    function getPosts() {

        // Append 'wp/v2/posts/ to the wpRestURL
        // Limit the number of posts to 3
        axios({
            method: 'get',
            url: wpRestUrl + '__CHANGE__',
            params: {
                per_page: __CHANGE__
            }
        })
            .then( function( response ) {

                // Clear the page
                __CHANGE__.innerHTML = __CHANGE__;

                // Loop through the posts (response.data)
                for( post of __CHANGE__ ) {
                    // Pass the post to the renderPost function
                    renderPost( __CHANGE__ );
                }

                // Get the links inside of h2 tags
                let links = document.querySelectorAll( '__CHANGE__' );
                // Loop through the links
                for( link of __CHANGE__ ) {
                    // Call getPost when the link is clicked
                    link.addEventListener( '__CHANGE__', __CHANGE__ );
                }

            });

    }

    function renderPost( post ) {

        // Create an h2 element
        let h2 = document.createElement( '__CHANGE__' ),
            markup = '';

        // Set the link as post.link
        // Set the data-id as the post.id
        // Add post.title.rendered inside the link
        markup += `<a href="#${__CHANGE__}" data-id="${__CHANGE__}">`;
        markup += __CHANGE__;
        markup += '</a>';

        // Set the innerHTML of the h2 to the markup
        // Append the h2 to the main page container
        __CHANGE__.innerHTML = __CHANGE__;
        __CHANGE__.appendChild( __CHANGE__ );

    }

    function getPost( event ) {

        // Ge the id from the link data-id
        let id = event.target.dataset.id;

        // Append the id to the url
        axios({
            method: 'get',
            url: wpRestUrl + 'wp/v2/posts/' + __CHANGE__
        })
            .then( function( response ) {

                // Clear the page
                container.innerHTML = '';

                // Pass response.data as a parameter to the renderFullPost function
                renderFullPost( __CHANGE__ );

            });

    }

    // Set the parameter to be named post
    function renderFullPost( __CHANGE__ ) {

        // Create an article tag
        let article = document.createElement('__CHANGE__'),
            markup = '';

        // Add post class to article
        article.classList.add( '__CHANGE__' );

        // Create the markup for the page
        // Create a backlink with a class of back
        // Set the title to post.title.rendered
        // Set the content to post.content.rendered
        markup += '<p><a class="__CHANGE__" href="#">Go Back</a></p>';
        markup += `<h1>${__CHANGE__}</h1>`;
        markup += `<div class="entry-content">${__CHANGE__}</div>`;

        // Set the markup as the article innerHTML
        __CHANGE__.innerHTML = __CHANGE__;

        // Attach an event listener to the back link
        // Call getPosts when the link is clicked
        article.querySelector( '__CHANGE__' ).addEventListener( 'click', __CHANGE__ );

        // Append the article to the page
        __CHANGE__.appendChild( __CHANGE__ );

    }

</script>


</body>
</html>
